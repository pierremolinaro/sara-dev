//---------------------------------------------------------------------------*
//                                                                           *
//                         File 'sara_scanner.cpp'                           *
//               Generated by version 0.14.1 (LL(1) grammar)                 *
//                     february 4th, 2005, at 16h52'56"                      *
//                                                                           *
// This program is free software; you can redistribute it and/or modify it   *
// under the terms of the GNU General Public License as published by the     *
// Free Software Foundation.                                                 *
//                                                                           *
// This program is distributed in the hope it will be useful, but WITHOUT    *
// ANY WARRANTY; without even the implied warranty of MERCHANDIBILITY or     *
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for  *
// more details.                                                             *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

#include <ctype.h>
#include <string.h>

#include "sara_scanner.h"

#include "galgas/lexical_actions.h" // Generated by 'include "..."'

//--- START OF USER ZONE 2


//--- END OF USER ZONE 2

//---------------------------------------------------------------------------*
//                                                                           *
//                               Constructor                                 *
//                                                                           *
//---------------------------------------------------------------------------*

sara_scanner::
sara_scanner (AC_galgas_io * inGalgasInputOutput)
: C_lexique (inGalgasInputOutput) {
  ulongValue = 0 ;
  identifierString.clearString () ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//                        Lexical error message list                         *
//                                                                           *
//---------------------------------------------------------------------------*

//--- Message 0 (decimalNumberTooLarge) :
static const char * gErrorMessage_0 = "decimal number too large" ;
//--- Message 1 (internalError) :
static const char * gErrorMessage_1 = "internal error" ;
//--- Message 2 (incorrectEndOfComment) :
static const char * gErrorMessage_2 = "incorrect end of comment" ;

//---------------------------------------------------------------------------*
//                                                                           *
//                          Syntax error messages                            *
//                                                                           *
//---------------------------------------------------------------------------*

//--- Syntax error message for terminal '$identifier$' :
static const char * gSyntaxErrorMessage_identifier = "an identifier" ;
//--- Syntax error message for terminal '$auto$' :
static const char * gSyntaxErrorMessage_auto = "the 'auto' key word" ;
//--- Syntax error message for terminal '$state$' :
static const char * gSyntaxErrorMessage_state = "the 'state' key word" ;
//--- Syntax error message for terminal '$first$' :
static const char * gSyntaxErrorMessage_first = "the 'first' key word" ;
//--- Syntax error message for terminal '$goto$' :
static const char * gSyntaxErrorMessage_goto = "the 'goto' key word" ;
//--- Syntax error message for terminal '$timer$' :
static const char * gSyntaxErrorMessage_timer = "the 'timer' key word" ;
//--- Syntax error message for terminal '$true$' :
static const char * gSyntaxErrorMessage_true = "the 'true' key word" ;
//--- Syntax error message for terminal '$false$' :
static const char * gSyntaxErrorMessage_false = "the 'false' key word" ;
//--- Syntax error message for terminal '$,$' :
static const char * gSyntaxErrorMessage__2C = "the ',' delimitor" ;
//--- Syntax error message for terminal '$;$' :
static const char * gSyntaxErrorMessage__3B = "the ';' delimitor" ;
//--- Syntax error message for terminal '$:$' :
static const char * gSyntaxErrorMessage__3A = "the ':' delimitor" ;
//--- Syntax error message for terminal '${$' :
static const char * gSyntaxErrorMessage__7B = "the '{' delimitor" ;
//--- Syntax error message for terminal '$}$' :
static const char * gSyntaxErrorMessage__7D = "the '}' delimitor" ;
//--- Syntax error message for terminal '$->$' :
static const char * gSyntaxErrorMessage__2D_3E = "the '->' delimitor" ;
//--- Syntax error message for terminal '$&$' :
static const char * gSyntaxErrorMessage__26 = "the '&' delimitor" ;
//--- Syntax error message for terminal '$!$' :
static const char * gSyntaxErrorMessage__21 = "the '!' delimitor" ;
//--- Syntax error message for terminal '$|$' :
static const char * gSyntaxErrorMessage__7C = "the '|' delimitor" ;
//--- Syntax error message for terminal '$($' :
static const char * gSyntaxErrorMessage__28 = "the '(' delimitor" ;
//--- Syntax error message for terminal '$)$' :
static const char * gSyntaxErrorMessage__29 = "the ')' delimitor" ;
//--- Syntax error message for terminal '$:=$' :
static const char * gSyntaxErrorMessage__3A_3D = "the ':=' delimitor" ;
//--- Syntax error message for terminal '$||$' :
static const char * gSyntaxErrorMessage__7C_7C = "the '||' delimitor" ;
//--- Syntax error message for terminal '$literal_integer$' :
static const char * gSyntaxErrorMessage_literal_5Finteger = "a decimal number" ;
//---------------------------------------------------------------------------*

void sara_scanner::
appendTerminalMessageToSyntaxErrorMessage (const sint16 inTerminalIndex,
                                           C_string & outSyntaxErrorMessage) {
  static const char * syntaxErrorMessageArray [23] = {"end of source",
       gSyntaxErrorMessage_identifier,
       gSyntaxErrorMessage_auto,
       gSyntaxErrorMessage_state,
       gSyntaxErrorMessage_first,
       gSyntaxErrorMessage_goto,
       gSyntaxErrorMessage_timer,
       gSyntaxErrorMessage_true,
       gSyntaxErrorMessage_false,
       gSyntaxErrorMessage__2C,
       gSyntaxErrorMessage__3B,
       gSyntaxErrorMessage__3A,
       gSyntaxErrorMessage__7B,
       gSyntaxErrorMessage__7D,
       gSyntaxErrorMessage__2D_3E,
       gSyntaxErrorMessage__26,
       gSyntaxErrorMessage__21,
       gSyntaxErrorMessage__7C,
       gSyntaxErrorMessage__28,
       gSyntaxErrorMessage__29,
       gSyntaxErrorMessage__3A_3D,
       gSyntaxErrorMessage__7C_7C,
       gSyntaxErrorMessage_literal_5Finteger} ;
  outSyntaxErrorMessage << syntaxErrorMessageArray [inTerminalIndex] ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//                      Key words table 'keyWordList'                        *
//                                                                           *
//---------------------------------------------------------------------------*

const sint16 sara_scanner::sara_scanner_table_size_keyWordList = 7 ;

const C_lexique_table_entry sara_scanner::sara_scanner_table_for_keyWordList [7] = {
  C_lexique_table_entry ("auto", 4, sara_scanner_1_auto),
  C_lexique_table_entry ("goto", 4, sara_scanner_1_goto),
  C_lexique_table_entry ("true", 4, sara_scanner_1_true),
  C_lexique_table_entry ("false", 5, sara_scanner_1_false),
  C_lexique_table_entry ("first", 5, sara_scanner_1_first),
  C_lexique_table_entry ("state", 5, sara_scanner_1_state),
  C_lexique_table_entry ("timer", 5, sara_scanner_1_timer)
} ;

sint16 sara_scanner::search_into_keyWordList (const C_string & inSearchedString) {
  return searchInList (inSearchedString, sara_scanner_table_for_keyWordList, sara_scanner_table_size_keyWordList) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//                     Key words table 'delimitorsList'                      *
//                                                                           *
//---------------------------------------------------------------------------*

const sint16 sara_scanner::sara_scanner_table_size_delimitorsList = 13 ;

const C_lexique_table_entry sara_scanner::sara_scanner_table_for_delimitorsList [13] = {
  C_lexique_table_entry ("!", 1, sara_scanner_1__21),
  C_lexique_table_entry ("&", 1, sara_scanner_1__26),
  C_lexique_table_entry ("(", 1, sara_scanner_1__28),
  C_lexique_table_entry (")", 1, sara_scanner_1__29),
  C_lexique_table_entry (",", 1, sara_scanner_1__2C),
  C_lexique_table_entry (":", 1, sara_scanner_1__3A),
  C_lexique_table_entry (";", 1, sara_scanner_1__3B),
  C_lexique_table_entry ("{", 1, sara_scanner_1__7B),
  C_lexique_table_entry ("|", 1, sara_scanner_1__7C),
  C_lexique_table_entry ("}", 1, sara_scanner_1__7D),
  C_lexique_table_entry ("->", 2, sara_scanner_1__2D_3E),
  C_lexique_table_entry (":=", 2, sara_scanner_1__3A_3D),
  C_lexique_table_entry ("||", 2, sara_scanner_1__7C_7C)
} ;

sint16 sara_scanner::search_into_delimitorsList (const C_string & inSearchedString) {
  return searchInList (inSearchedString, sara_scanner_table_for_delimitorsList, sara_scanner_table_size_delimitorsList) ;
}

//---------------------------------------------------------------------------*
//                                                                           *
//               Get next token : method 'parseLexicalToken'                 *
//                                                                           *
//---------------------------------------------------------------------------*

void sara_scanner::
parseLexicalToken (const bool inPropagateLexicaleErrorException) {
  bool loop_ = true ;
  mCurrentTokenCode = -1 ;
  ulongValue = 0 ;
  identifierString.clearString () ;
  while (mCurrentTokenCode < 0) {
    mCurrentTokenStartLocation = getCurrentLocation () ;
    try{
      if (testForInputChar ('a', 'z') ||
          testForInputChar ('A', 'Z')) {
        do {
          enterCharacterIntoString (identifierString, getPreviousChar (), * this) ;
          if (testForInputChar ('a', 'z') ||
              testForInputChar ('A', 'Z') ||
              testForInputChar ('_') ||
              testForInputChar ('0', '9')) {
          }else{
            loop_ = false ;
          }
        }while (loop_) ;
        loop_ = true ;
        mCurrentTokenCode = search_into_keyWordList (identifierString) ;
        if (mCurrentTokenCode == -1) {
          mCurrentTokenCode = sara_scanner_1_identifier ;
        }
      }else if (testForInputString ("->", 2)) {
        mCurrentTokenCode = sara_scanner_1__2D_3E ;
      }else if (testForInputString (":=", 2)) {
        mCurrentTokenCode = sara_scanner_1__3A_3D ;
      }else if (testForInputString ("||", 2)) {
        mCurrentTokenCode = sara_scanner_1__7C_7C ;
      }else if (testForInputString (",", 1)) {
        mCurrentTokenCode = sara_scanner_1__2C ;
      }else if (testForInputString (";", 1)) {
        mCurrentTokenCode = sara_scanner_1__3B ;
      }else if (testForInputString (":", 1)) {
        mCurrentTokenCode = sara_scanner_1__3A ;
      }else if (testForInputString ("{", 1)) {
        mCurrentTokenCode = sara_scanner_1__7B ;
      }else if (testForInputString ("}", 1)) {
        mCurrentTokenCode = sara_scanner_1__7D ;
      }else if (testForInputString ("&", 1)) {
        mCurrentTokenCode = sara_scanner_1__26 ;
      }else if (testForInputString ("!", 1)) {
        mCurrentTokenCode = sara_scanner_1__21 ;
      }else if (testForInputString ("|", 1)) {
        mCurrentTokenCode = sara_scanner_1__7C ;
      }else if (testForInputString ("(", 1)) {
        mCurrentTokenCode = sara_scanner_1__28 ;
      }else if (testForInputString (")", 1)) {
        mCurrentTokenCode = sara_scanner_1__29 ;
      }else if (testForInputChar ('0', '9')) {
        enterDigitIntoUlong (ulongValue, getPreviousChar (), gErrorMessage_0, gErrorMessage_1, * this) ;
        do {
          if (testForInputChar ('0', '9')) {
            enterDigitIntoUlong (ulongValue, getPreviousChar (), gErrorMessage_0, gErrorMessage_1, * this) ;
          }else if (testForInputChar ('_')) {
          }else{
            loop_ = false ;
          }
        }while (loop_) ;
        loop_ = true ;
        mCurrentTokenCode = sara_scanner_1_literal_5Finteger ;
      }else if (testForInputChar (((char) 0x1), ' ')) {
      }else if (testForInputChar ('#')) {
        do {
          if (testForInputChar (((char) 0x1), '\t') ||
              testForInputChar ('\v', ((char) 0xFF))) {
          }else{
            loop_ = false ;
          }
        }while (loop_) ;
        loop_ = true ;
        if (testForInputChar ('\n')) {
        }else{
          lexicalError (gErrorMessage_2) ;
        }
      }else if (testForInputChar ('\0')) { // End of source text ? 
        mCurrentTokenCode = sara_scanner_1_ ; // Empty string code
      }else{ // Unknown input character
        lexicalError ("Unknown character") ;
      }
    }catch (const C_lexicalErrorException &) {
      mCurrentTokenCode = -1 ; // No token
      advance () ; // ... go throught unknown character
      if (inPropagateLexicaleErrorException) {
        throw ;
      }
    }
  }
}

//---------------------------------------------------------------------------*
//                                                                           *
//                            Styles definition                              *
//                                                                           *
//---------------------------------------------------------------------------*

sint32 sara_scanner::getStylesCount (void) {
  return 5 ;
}

//---------------------------------------------------------------------------*

const char * sara_scanner::getStyleName (const sint32 inIndex) {
  const char * kStylesArray [6] = {"Default style", "Identifiers", "Key words", "Delimitors", "Integer constants", NULL} ;
  return (inIndex < 5) ? kStylesArray [inIndex] : NULL ;
} ;

//---------------------------------------------------------------------------*

uint8 sara_scanner::
getTerminalStyleIndex (const sint32 inTerminal) {
  static const uint8 kTerminalSymbolStyles [23] = {0,
    1 /* sara_scanner_1_identifier */,
    2 /* sara_scanner_1_auto */,
    2 /* sara_scanner_1_state */,
    2 /* sara_scanner_1_first */,
    2 /* sara_scanner_1_goto */,
    2 /* sara_scanner_1_timer */,
    2 /* sara_scanner_1_true */,
    2 /* sara_scanner_1_false */,
    3 /* sara_scanner_1__2C */,
    3 /* sara_scanner_1__3B */,
    3 /* sara_scanner_1__3A */,
    3 /* sara_scanner_1__7B */,
    3 /* sara_scanner_1__7D */,
    3 /* sara_scanner_1__2D_3E */,
    3 /* sara_scanner_1__26 */,
    3 /* sara_scanner_1__21 */,
    3 /* sara_scanner_1__7C */,
    3 /* sara_scanner_1__28 */,
    3 /* sara_scanner_1__29 */,
    3 /* sara_scanner_1__3A_3D */,
    3 /* sara_scanner_1__7C_7C */,
    4 /* sara_scanner_1_literal_5Finteger */
  } ;
  return kTerminalSymbolStyles [inTerminal] ;
}

//---------------------------------------------------------------------------*

